const $=new API("jd_ck_remark"),APIKey="CookiesJD",CacheKey=`#${APIKey}`,remark_key=`remark`,searchKey="keyword";$.url=$request.url,$.html=$response.body;const isJS=$.url.match(/^https:\/\/.*\.com\/.*(\.js)/);try{$.html.includes&&$.html.includes("</html>")||$.done({body:$.html})}catch(n){$.done()}const isLogin=$.url.indexOf("/login/login")>-1;function getRem(n){return`${25*n}vw`}function initBoxJSData(){const n=JSON.parse($.read(CacheKey)||"[]");let e=JSON.parse($.read(remark_key)||"[]");const t=($.read(searchKey)||"").split(","),i={};return e.forEach(n=>{i[n.username]=n}),(e=n.map(n=>({...n,username:n.userName,nickname:n.userName,...i[n.userName]})).filter(n=>!!n.cookie)).filter((n,e)=>!t[0]||t.indexOf(`${e}`)>-1||t.indexOf(n.username)>-1||t.indexOf(n.nickname)>-1||t.indexOf(n.status)>-1)}$.headers=$response.headers;const cookiesRemark=initBoxJSData();function createStyle(){return`\n<style>\n   #cus-mask .iconfont{\n     font-size: ${getRem(.2)};\n   }\n   #cus-mask p,#cus-mask span{\n    padding: 0;\n    margin: 0;\n   }\n  .tool_bars{\n    position: fixed;\n    top:50%;\n    right: 0;\n    z-index: 999;\n    transform: translateY(-50%);\n  }\n  .tool_bar_jf{\n    position: fixed;\n    top: 80%;\n    right: 0;\n    z-index: 999;\n    transform: translateY(-50%);\n  }\n  .tool_bar{\n    display: flex;\n    height:33px;\n    width:33px;\n    align-items: center;\n    background: #f7bb10;\n    padding-left: 2px;\n    border-top-left-radius: 50%;\n    border-bottom-left-radius: 50%;\n    padding-right: 3px;\n    color: #fff;\n    font-size: ${getRem(.1)};\n    margin-bottom: ${getRem(.1)};\n    border-top: 1px solid #e8e8e8;\n    border-bottom: 1px solid #e8e8e8;\n    border-left: 1px solid #e8e8e8;\n  }\n  .tool_bar img,.tool_bar span{\n    border-radius: 50%;\n    border:1px solid #fff;\n    width: 27px;\n    height: 27px;\n    line-height: 27px;\n    text-align: center;\n    display: block;\n    font-size: ${getRem(.25)};\n  }\n  .cus-mask{\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    z-index: 9999;\n    background: rgba(0,0,0,.6);\n  }\n  .cus-mask_view{\n    width: 85%;\n    background: #fff;\n    border-radius: ${getRem(.1)};\n    position: relative;\n    top: 50%;\n    left: 50%;\n    color: #2e2d2d;\n    transform: translate(-50%,-50%);\n    -ms-transform: translate(-50%,-50%);\n    -moz-transform: translate(-50%,-50%);\n    -webkit-transform: translate(-50%,-50%);\n    -o-transform: translate(-50%,-50%);\n  }\n  .cus-view{\n    font-size: ${getRem(.16)};\n    font-family: PingFangSC-Semibold;\n    text-align: center;\n    padding: 0 ${getRem(.13)} 0;\n    position: absolute;\n    top: ${getRem(.1)};\n    background: #fff;\n    left: 50%;\n    transform: translateX(-50%);\n    z-index: 999;\n    display:flex;\n    align-items: center;\n    border-radius: ${getRem(.1)};\n    box-shadow: 0 2px 5px #ecc4d8;\n  }\n  .cus-content{\n    font-family: PingFangSC-Regular;\n    font-size: ${getRem(.14)};\n    line-height: ${getRem(.22)};\n    padding: ${getRem(.25)} ${getRem(.1)} 0;\n    position: relative;\n  }\n  .cus-content label{\n    color: rgba(0,0,0,.4);\n    font-size: ${getRem(.16)};\n    margin-bottom: ${getRem(.2)};\n    display: block\n  }\n  .cus-content ul{\n    padding-left: ${getRem(.2)};\n    color: rgba(0,0,0,.4);\n    margin-top: ${getRem(.1)};\n    font-size: ${getRem(.1)}\n  }\n  .cus-content li{\n    list-style-type: cjk-ideographic;\n  }\n  .cus-footer{\n    margin-top: ${getRem(.09)};\n    border-radius: ${getRem(.1)};\n    -webkit-box-shadow: 0 -${getRem(.025)} ${getRem(.05)} 0 rgb(0 0 0/10%);\n    box-shadow: 0 -${getRem(.025)} ${getRem(.05)} 0 rgb(0 0 0/10%);\n  }\n  .cus-footer .abtn{\n    display: inline-block;\n    font-family: PingFangSC-Regular;\n    font-size: ${getRem(.15)};\n    color: #2e2d2d;\n    text-align: center;\n    height: ${getRem(.45)};\n    line-height: ${getRem(.45)};\n    width: 50%;\n    border-top: 1px solid #eaeaea;\n  }\n  .cus-footer span{\n    font-size: ${getRem(.15)};\n  }\n  .border-btn{\n    border-left: 1px solid #eaeaea;\n    border-top: 1px solid #eaeaea;\n  }\n  .cus-footer .btn-ok{\n    color: #fff;\n    background-image: -webkit-gradient(linear,left top,right top,from(#f7bb10),to(#ff4f18));\n    background-image: -webkit-linear-gradient(left,#f7bb10,#ff4f18);\n    background-image: -o-linear-gradient(left,#f7bb10,#ff4f18);\n    background-image: linear-gradient(90deg,#f7bb10,#ff4f18);\n    border-radius: 0 0 ${getRem(.1)} 0;\n  }\n  #cus-tip{\n    position: fixed;\n    z-index: 9999;\n    background: rgba(0,0,0,.5);\n    color: #fff;\n    min-width: ${getRem(1)};\n    min-height:${getRem(.35)} ;\n    max-width: 80%;\n    max-height: 50%;\n    overflow-y: scroll;\n    top:50%;\n    left: 50%;\n    text-align: center;\n    padding: ${getRem(.1)};\n    box-sizing: border-box;\n    font-size: ${getRem(.1)};\n    border-radius: ${getRem(.1)};\n    transform: translate(-50%,-50%);\n    -ms-transform: translate(-50%,-50%);\n    -moz-transform: translate(-50%,-50%);\n    -webkit-transform: translate(-50%,-50%);\n    -o-transform: translate(-50%,-50%);\n  }\n  #account_list{\n    border: 4px solid #f7bb10;\n    border-radius: ${getRem(.3)};\n    height: ${getRem(1.98)};\n    overflow-x: hidden;\n    overflow-y: scroll;\n    padding: ${getRem(.06)} ${getRem(.1)};\n    box-sizing: border-box;\n  }\n  .cus-avatar{\n     padding: ${getRem(.05)};\n     display: flex;\n     align-items: center;\n     border: 1px solid #eee;\n     border-radius: ${getRem(.2)};\n     box-sizing: border-box;\n     position: relative;\n     margin-bottom: ${getRem(.1)};\n     height: ${getRem(.5)};\n  }\n  .avatar_img{\n    width: ${getRem(.35)};\n    height: ${getRem(.35)};\n    border-radius: 50%;\n    font-size: ${getRem(.1)};\n    border: 1px solid #f7bb10;\n    overflow: hidden;\n    padding: ${getRem(.1)};\n    white-space: nowrap;\n    background-size: contain;\n    box-sizing: border-box;    \n    position: relative;\n  }\n  .cususer_info{\n    margin-left: ${getRem(.1)};\n    display: flex;\n    align-items: start;\n    flex-direction: column;\n    flex:1 0;\n  }\n  .cus-icon{\n    display: block;\n    width: 5px;\n    height: 5px;\n    border-radius: 50%;\n    border: 1px solid #52c41a;\n    position: absolute;\n    font-size: ${getRem(.05)};\n    right: ${getRem(.15)};\n    top: 50%;\n    transform: translateY(-50%);\n    text-align: center;\n    line-height: ${getRem(.3)};\n    box-shadow: 0 0 4px #52c41a;\n    animation: flash 2s linear infinite;\n  }\n  .cususer_info p {\n    font-weight: bold;\n    font-size: ${getRem(.1)};\n    line-height: 1.8;\n  }\n  .cususer_info span{\n    font-weight: unset;\n    color: #666;\n    font-size: ${getRem(.08)};\n    line-height: 1.8;\n  }\n  .not_content{\n    text-align: center;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n\n  .cus-err{\n    border-color: red;\n    animation: flashred 2s linear infinite;\n    box-shadow: 0 0 4px red;\n  }\n\n  .cus-active{\n    border-color: #91d5ff;\n    box-shadow: 0 0 4px #91d5ff;\n  }\n\n  .cus-now_active{\n    border-color: #a0d911;\n    box-shadow: unset;\n  }\n\n  @keyframes flashred{\n    0%{ box-shadow: 0 0 4px red}\n    25%{ box-shadow: 0 0 6px red}\n    50%{ box-shadow: 0 0 10px red}\n    75%{ box-shadow: 0 0 6px red}\n    100%{ box-shadow: 0 0 4px red}\n  }\n\n  @keyframes flash{\n    0%{ box-shadow: 0 0 4px #52c41a}\n    25%{ box-shadow: 0 0 6px #52c41a}\n    50%{ box-shadow: 0 0 10px #52c41a}\n    75%{ box-shadow: 0 0 6px #52c41a}\n    100%{ box-shadow: 0 0 4px #52c41a}\n  }\n  .ant-tag{\n   font-size: ${getRem(.08)} !important;\n   margin-right:${getRem(.3)} !important;\n  }\n  .ant-tag-cyan{\n    color: #ffa39e !important;\n  }\n  .ant-tag-magenta{\n    color: #adc6ff !important;\n  }\n  \n  .cus_input {\n    border: none;\n    background: none;\n    flex: 1 0;\n  }\n  #cu_search{\n    display: flex;\n    height: ${getRem(.25)};\n    align-items: center;\n  }\n  .input{\n    display: inline-block;\n    width: 100%;\n    border: none;\n    background: #fff;\n    font-size: ${getRem(.1)};\n    -webkit-box-align: center;\n    line-height: ${getRem(.32)};\n    padding-left: 10px;\n    box-sizing: border-box;\n    border-radius: ${getRem(.1)};\n    height: ${getRem(.32)};\n    overflow: hidden;\n  }\n  .cu_search_input{\n    display: flex;\n  }\n  #cus_cancel{\n    font-weight: unset;\n    margin-left: 3px !important;\n    white-space: nowrap;\n    font-size: ${getRem(.1)};\n  }\n  .hidden {\n    display: none !important;\n  }\n  #cus-mask .ant-ribbon {\n    box-sizing: border-box;\n    margin: 0 5px 0 0;\n    color: #eb2f96;\n    border-radius: 50%;\n    opacity: 0.5;\n    text-align: center;\n    display:inline-block;\n    transform: scale(0.7);\n  }\n  .avatar_container{\n    position: relative;\n    margin-left: ${getRem(.05)};\n  }\n  .isPlus{\n    width: ${getRem(.4)};\nz-index:99;    height: ${getRem(.4)};\n    position: absolute;\n    left: -1px;\n    top: -3px;\n    pointer-events: none;\n    background:url(https://img12.360buyimg.com/img/s115x118_jfs/t1/127010/39/7866/7131/5f18f9afE8e5c1d37/1713cb8c5a329d3f.png) no-repeat scroll 50%/cover\n  }\n  .avatar_img img{\n    min-width: 1px;\n    min-height: 1px;\n    border-radius: 50%;\n    width: 100%;\n    height: auto;\n    transform: translate3d(-50%,-50%,0);\n    position: absolute;\n    left: 50%;\n    top: 50%;\n  }\n  .plus .avatar_img{\n    border:none;\n  }\n</style>\n`}const accounts=cookiesRemark.map((n,e)=>{const t="正常"===n.status,i=n.wskey?"ant-tag-cyan":"ant-tag-magenta",s=n.wskey?"APP":"WEB";return`\n<div class="cus-avatar" data-value="${n.mobile||""}" data-name="${n.username}">\n  \n  <div class="avatar_container ${"1"===n.isPlusVip?"plus":""}">\n    <div class="avatar_img">\n      <img src="${n.avatar||"//img11.360buyimg.com/jdphoto/s120x120_jfs/t21160/90/706848746/2813/d1060df5/5b163ef9N4a3d7aa6.png"}" alt="${n.username}" />\n    </div>\n    ${"1"===n.isPlusVip?`<div class="isPlus"></div>`:""}\n  </div>\n  <div class="cususer_info">\n     <p>${n.nickname} </p>\n     <span><b class="ant-ribbon">${e+1}</b>${n.username}</span>\n  </div>\n  \n  <span class="ant-tag ${i}">${s}</span>\n  <span class="cus-icon ${t?"":"cus-err"}"></span>\n</div>`}).join("");function createHTML(){return`\n<div id="cus-mask" class="cus-mask" style="visibility:hidden">\n  <div class="cus-mask_view">\n    <div class="cus-content">\n      <div class="cus-view">\n        <div id="cu_search_input" class="cu_search_input input hidden">\n           <input placeholder="请输入昵称" type="text" class="cus_input"/>\n           <span id="cu_search_close" class="iconfont icon-close"></span>\n        </div>\n        <span id="cus_cancel" class="hidden">取消</span>\n       <div id="cu_search">\n          <span id="cus-username">京东账号列表</span>\n          <span class="iconfont icon-search"></span>\n        </div>\n      </div>\n      <div id="account_list">\n          ${accounts.length?accounts:'<div class="not_content">未找到账号</div>'}\n      </div>\n    </div>\n    <div class="cus-footer">\n        <div class="btn-wrap" style="display: flex">\n          <span class="abtn iconfont icon-cancel" id="cus-mask-cancel"></span>\n          <span class="abtn border-btn iconfont icon-dengchu" id="clear-ck"></span>\n          <span class="abtn border-btn iconfont icon-fuzhi" id="copyCk"></span>\n          <span class="abtn btn-ok iconfont ${isLogin?"icon-denglu":"icon-zhuanhuan"}" id="cus-mask-ok" ></span>\n        </div>\n    </div>\n  </div>\n</div>\n<div class="cus-mask" id="jf_mask" style="visibility:hidden">\n    <div class="cus-mask_view"></div>\n</div>\n<div id="cus-tip" style="display: none;"></div>\n<div class="tool_bars" id="tool-bars">\n  <div id="boxjs" class="tool_bar">\n   <img  src="https://raw.githubusercontent.com/chavyleung/scripts/master/BOXJS.png" />\n  </div>\n</div>\n  `}const fillMobile=`<span class="abtn border-btn iconfont icon-shouye" id="fill-input"></span>`;function createScript(){return`\n<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"><\/script>  \n<script>\n  var pk = getCookie("pt_key");\n  var pp = decodeURIComponent(getCookie("pt_pin"));\n  var isLogin = window.location.href.indexOf("/login/login")>-1;\n  const head = document.getElementsByTagName("head")[0];\n  head.insertAdjacentHTML('beforeEnd', '<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" /><link rel="stylesheet" type="text/css" href="//at.alicdn.com/t/font_2100531_wsbm3g7wlhg.css" charset="utf-8"/>');\n\n  const jd_ck = ${JSON.stringify(cookiesRemark)};\n  const boxjs_btn = document.querySelector("#boxjs");\n  let fill_btn = document.querySelector("#fill-input");\n  const copyCk_btn = document.querySelector("#copyCk");\n  const cancel_btn = document.querySelector("#cus-mask-cancel");\n  const ok_btn = document.querySelector("#cus-mask-ok");\n  let clear_btn = document.querySelector("#clear-ck");\n  const tip_view = document.querySelector("#cus-tip");\n  let avatarView = document.querySelectorAll(".cus-avatar");\n  const usernameView = document.querySelector("#cus-username");\n  const toolView = document.querySelector("#tool-bars");\n  const account_list = document.querySelector("#account_list");\n  const cu_search = document.querySelector("#cu_search");\n  const cu_search_close = document.querySelector("#cu_search_close");\n  const cu_search_input = document.querySelector("#cu_search_input");\n  const $input = document.querySelector("#cu_search_input input");\n  const cus_cancel = document.querySelector("#cus_cancel");\n  \n  function classFunc(element,str){\n    let newClass = element.className.split(" ");\n    if(newClass.indexOf(str)>-1){\n      element.className = newClass.filter(item => item!==str).join(" ");\n      return\n    }\n    newClass.push(str);\n    return element.className = newClass.join(" ")\n  }\n  \n  cu_search.addEventListener("click",function(){\n     classFunc(cu_search, "hidden");\n     classFunc(usernameView,"hidden");\n     classFunc(cu_search_input, "hidden");\n     classFunc(cus_cancel,"hidden");\n  })\n  \n  cus_cancel.addEventListener("click",function(){\n    cu_search.click();\n    cu_search_close.click();\n    registerClick();\n  })\n  \n  cu_search_close.addEventListener("click",function(){\n    $input.value = "";\n    account_list.innerHTML = getAccountList(jd_ck);\n  })\n  \n  function getAccountList(cks){\n   return  cks.map((item,index) => {\n  const status = item.status === '正常';\n  const className = item.wskey ? 'ant-tag-cyan' : 'ant-tag-magenta';\n  const tag = item.wskey ? 'APP' : 'WEB';\n  return \`\n<div class="cus-avatar" data-value="\${item.mobile||''}" data-name="\${item.username}">\n  <div class="avatar_container \${item.isPlusVip==='1' ? 'plus' : ''}">\n    <div class="avatar_img">\n      <img src="\${\n        item.avatar ||\n        '//img11.360buyimg.com/jdphoto/s120x120_jfs/t21160/90/706848746/2813/d1060df5/5b163ef9N4a3d7aa6.png'\n      }" alt="\${item.username}" />\n    </div>\n    \${item.isPlusVip==='1' ? \`<div class="isPlus"></div>\` : ''}\n  </div>\n\n  <div class="cususer_info">\n     <p>\${item.nickname}</p>\n     <span><b class="ant-ribbon">\${index + 1}</b>\${item.username}</span>\n  </div>\n  <span class="ant-tag \${className}">\${tag}</span>\n  <span class="cus-icon \${status ? '' : 'cus-err'}"></span>\n</div>\`;\n}).join('')\n  }\n  \n  let timer = null;\n  function inputChange(event){\n   const value = event.target.value;\n   if(!value) return;\n   let newList = [];\n   if(timer) clearTimeout(timer);\n   timer = setTimeout(()=>{ \n     newList = jd_ck.filter(item=>item.username.indexOf(value)>-1 || item.nickname.indexOf(value)>-1)\n     if(!newList.length) return;\n     account_list.innerHTML = getAccountList(newList);\n     registerClick()\n    },500);\n  }\n  \n   $input.addEventListener("input",inputChange)\n   const avatarItem = jd_ck.find(item=> item.username === pp);\n   if(avatarItem && avatarItem.avatar){\n     boxjs_btn.innerHTML = "<img src='"+ avatarItem.avatar +"' />";\n   }\n   if(pk === "" || !pk){\n    copyCk_btn.style.display="none";\n    clear_btn.style.display="none";\n   }\n   \n   if(pp){\n      usernameView.innerHTML= pp;\n      var preIndex = null;\n      var nextIndex = null;\n      var current = null\n      jd_ck.forEach((item,index)=>{\n        if(item.username === pp){\n          current = index;\n          preIndex = index !== 0 ? index - 1 : null;\n          nextIndex = index !== jd_ck.length - 1 ? index + 1 : null;\n        }\n      })\n      if(preIndex!==null){\n        toolView.insertAdjacentHTML('afterbegin','<div id="preCK" class="tool_bar"><span class="iconfont icon-shangjiantou" /></div>')\n      }\n      if(nextIndex!==null){\n        toolView.insertAdjacentHTML('beforeEnd','<div id="nextCK" class="tool_bar"><span class="iconfont icon-xiajiantou" /></div>')\n      }\n\n      if(current) animateScroll(current);\n   };\n\n\n   function animateScroll(key) {\n      account_list.scrollTo({top: 52 * key});\n   }\n\n   var preCK = document.getElementById("preCK");\n   var nextCK = document.getElementById("nextCK");\n   if(preCK){\n     preCK.addEventListener('click',function() {\n      if(preIndex !== null) changeIndex(preIndex);\n     });\n   }\n\n   if(nextCK){\n     nextCK.addEventListener('click',function() {\n      if(nextIndex !== null) changeIndex(nextIndex);\n     });\n   }\n\n   function changeIndex(key){\n      avatarView.forEach((item,index)=>{\n        if(index === key){\n          item.className = "cus-avatar cus-active";\n          item.id = "jd_account";\n        } else {\n           item.className = "cus-avatar";\n           item.id = "";\n        }\n      });\n      btnSubmit();\n   }\n\n    function registerClick(){\n      avatarView = document.querySelectorAll(".cus-avatar");\n      fill_btn = document.querySelector("#fill-input");\n      clear_btn = document.querySelector("#clear-ck");\n\n      avatarView.forEach(item=>{\n       const username = item.getAttribute('data-name');\n        if(username === pp){\n          item.className = "cus-avatar cus-now_active";\n          item.id = "jd_account";\n        }\n        item.onclick = function (){\n          avatarView.forEach(item=>{\n              item.className = "cus-avatar";\n              item.id = "";\n          })\n          const mobile = this.getAttribute('data-value');\n          this.className = "cus-avatar cus-active";\n          this.id = "jd_account";\n          $("#fill-input").remove();\n          if(mobile){\n            copyToClipMobile(mobile);\n            if(isLogin) $("#cus-mask-cancel").after(\`${fillMobile}\`);\n            registerClick();\n          }\n        }\n      })\n\n      if(fill_btn){\n        fill_btn.addEventListener('click',function(){\n          fillInput();\n        });\n      }\n\n      if(clear_btn){\n        clear_btn.addEventListener('click',function(){\n           sessionStorage.clear();\n           localStorage.clear();\n           setCookie('pt_key',"");\n           setCookie("pt_pin","");\n           window.location.reload();\n        })\n      }\n    }\n    \n    registerClick();\n\n    boxjs_btn.addEventListener('click', function(){\n      maskVisible(true);\n    });\n\n    cancel_btn.addEventListener('click', function(){\n      maskVisible(false);\n    });\n\n    ok_btn.addEventListener('click', function(){\n      btnSubmit();\n    });\n\n\n    copyCk_btn.addEventListener('click',function(){\n      copyToClip();\n    })\n\n    function toast(message,time= 2000){\n       tip_view.style.display = "block";\n       tip_view.innerHTML = message;\n       setTimeout(function() {\n         tip_view.style.display = "none";\n          tip_view.innerHTML = "";\n       },parseInt(time || "2000"));\n    }\n\n    function maskVisible(visible){\n      const cusmsk = document.getElementById("cus-mask");\n      cusmsk.style.visibility = visible? "visible" : "hidden";\n    }\n\n    function fillInput(){\n      const sbBtn= document.getElementById('jd_account');\n      const cuMobile = sbBtn.getAttribute('data-value');\n      console.log('快速填充号码：'+ cuMobile);\n      const input = document.getElementsByClassName('acc-input mobile J_ping')[0];\n      input.value = cuMobile;\n      ev = document.createEvent("HTMLEvents");\n      ev.initEvent("input", true,false );\n      input.dispatchEvent(ev);\n      maskVisible(false);\n    }\n\n    function clearAllCookie() {\n        var keys = document.cookie.match(/[^ =;]+(?=\\=)/g);\n        if (keys) {\n            for (var i = keys.length; i--;){\n              document.cookie = keys[i] + '=;path=/;domain=.jd.com;expires=' + new Date(0).toUTCString()\n            }\n        }\n    }\n\n   function btnSubmit(){\n    const sbBtn= document.getElementById('jd_account');\n    if(!sbBtn) return alert("请选择需要登陆的账号");\n    const cuName = sbBtn.getAttribute('data-name');\n    const login_ck = jd_ck.find(item=>item.username===cuName);\n    if(!login_ck) return alert("未找到相关账号");\n    let [ pt_key , pt_pin ] = login_ck.cookie.split(";");\n    pt_key = pt_key.split("=");\n    pt_pin = pt_pin.split("=");\n    clearAllCookie();\n    setCookie(pt_key[0],pt_key[1]);\n    setCookie(pt_pin[0],pt_pin[1]);\n    window.location.reload();\n  }\n\n\n  function setCookie(cname,cvalue){\n      var ed = new Date();\n      const mt = ed.getMonth()+1;\n      ed.setMonth(mt);\n      var expires = "expires="+ed.toGMTString();\n      document.cookie = cname+"="+cvalue+"; "+expires+"; path=/; domain=.jingxi.com";\n      document.cookie = cname+"="+cvalue+"; "+expires+"; path=/; domain=.jd.com";\n  }\n\n  function getQueryVariable(variable){\n     var query = window.location.search.substring(1);\n     var vars = query.split("&");\n     for (var i=0;i<vars.length;i++) {\n             var pair = vars[i].split("=");\n             if(pair[0] == variable){return pair[1];}\n     }\n     return(false);\n  }\n  function getCookie(cname){\n      var name = cname + "=";\n      var ca = document.cookie.split(';');\n      for(var i=0; i<ca.length; i++) {\n          var c = ca[i].trim();\n          if (c.indexOf(name)==0) { return c.substring(name.length,c.length); }\n      }\n      return "";\n  }\n  function copyToClip(){\n    const _input = document.createElement('input');\n    _input.style.width="1px";\n    _input.style.height="1px";\n    _input.style.position="fixed";\n    _input.style.right="-1px";\n    document.body.prepend(_input);\n    _input.value = "pt_key="+pk+";pt_pin="+pp+";";\n    _input.focus();\n    _input.select();\n    document.execCommand('copy');\n    _input.blur();\n    document.body.removeChild(_input);\n    toast('复制成功');\n  }\n\n  function copyToClipMobile(mobile){\n    const _input = document.createElement('input');\n    _input.style.width="1px";\n    _input.style.height="1px";\n    _input.style.position="fixed";\n    _input.style.right="-1px";\n    document.body.prepend(_input);\n    _input.value = mobile;\n    _input.focus();\n    _input.select();\n    document.execCommand('copy');\n    _input.blur();\n    document.body.removeChild(_input);\n  }\n<\/script>\n  `}function ENV(){const n="undefined"!=typeof $task,e="undefined"!=typeof $loon,t="undefined"!=typeof $httpClient&&!e,i="function"==typeof require&&"undefined"!=typeof $jsbox;return{isQX:n,isLoon:e,isSurge:t,isNode:"function"==typeof require&&!i,isJSBox:i,isRequest:"undefined"!=typeof $request,isScriptable:"undefined"!=typeof importModule}}function HTTP(n={baseURL:""}){const{isQX:e,isLoon:t,isSurge:i,isScriptable:s,isNode:o}=ENV(),a=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/,r={};return["GET","POST","PUT","DELETE","HEAD","OPTIONS","PATCH"].forEach(c=>r[c.toLowerCase()]=(r=>(function(r,c){c="string"==typeof c?{url:c}:c;const l=n.baseURL;l&&!a.test(c.url||"")&&(c.url=l?l+c.url:c.url),c.body&&c.headers&&!c.headers["Content-Type"]&&(c.headers["Content-Type"]="application/x-www-form-urlencoded");const d=(c={...n,...c}).timeout,u={...{onRequest:()=>{},onResponse:n=>n,onTimeout:()=>{}},...c.events};let m,p;if(u.onRequest(r,c),e)m=$task.fetch({method:r,...c});else if(t||i||o)m=new Promise((n,e)=>{(o?require("request"):$httpClient)[r.toLowerCase()](c,(t,i,s)=>{t?e(t):n({statusCode:i.status||i.statusCode,headers:i.headers,body:s})})});else if(s){const n=new Request(c.url);n.method=r,n.headers=c.headers,n.body=c.body,m=new Promise((e,t)=>{n.loadString().then(t=>{e({statusCode:n.response.statusCode,headers:n.response.headers,body:t})}).catch(n=>t(n))})}const f=d?new Promise((n,e)=>{p=setTimeout(()=>(u.onTimeout(),e(`${r} URL: ${c.url} exceeds the timeout ${d} ms`)),d)}):null;return(f?Promise.race([f,m]).then(n=>(clearTimeout(p),n)):m).then(n=>u.onResponse(n))})(c,r))),r}function API(n="untitled",e=!1){const{isQX:t,isLoon:i,isSurge:s,isNode:o,isJSBox:a,isScriptable:r}=ENV();return new class{constructor(n,e){this.name=n,this.debug=e,this.http=HTTP(),this.env=ENV(),this.node=(()=>o?{fs:require("fs")}:null)(),this.initCache(),Promise.prototype.delay=function(n){return this.then(function(e){return((n,e)=>new Promise(function(t){setTimeout(t.bind(null,e),n)}))(n,e)})}}initCache(){if(t&&(this.cache=JSON.parse($prefs.valueForKey(this.name)||"{}")),(i||s)&&(this.cache=JSON.parse($persistentStore.read(this.name)||"{}")),o){let n="root.json";this.node.fs.existsSync(n)||this.node.fs.writeFileSync(n,JSON.stringify({}),{flag:"wx"},n=>console.log(n)),this.root={},n=`${this.name}.json`,this.node.fs.existsSync(n)?this.cache=JSON.parse(this.node.fs.readFileSync(`${this.name}.json`)):(this.node.fs.writeFileSync(n,JSON.stringify({}),{flag:"wx"},n=>console.log(n)),this.cache={})}}persistCache(){const n=JSON.stringify(this.cache,null,2);t&&$prefs.setValueForKey(n,this.name),(i||s)&&$persistentStore.write(n,this.name),o&&(this.node.fs.writeFileSync(`${this.name}.json`,n,{flag:"w"},n=>console.log(n)),this.node.fs.writeFileSync("root.json",JSON.stringify(this.root,null,2),{flag:"w"},n=>console.log(n)))}write(n,e){if(this.log(`SET ${e}`),-1!==e.indexOf("#")){if(e=e.substr(1),s||i)return $persistentStore.write(n,e);if(t)return $prefs.setValueForKey(n,e);o&&(this.root[e]=n)}else this.cache[e]=n;this.persistCache()}read(n){return this.log(`READ ${n}`),-1===n.indexOf("#")?this.cache[n]:(n=n.substr(1),s||i?$persistentStore.read(n):t?$prefs.valueForKey(n):o?this.root[n]:void 0)}delete(n){if(this.log(`DELETE ${n}`),-1!==n.indexOf("#")){if(n=n.substr(1),s||i)return $persistentStore.write(null,n);if(t)return $prefs.removeValueForKey(n);o&&delete this.root[n]}else delete this.cache[n];this.persistCache()}notify(n,e="",c="",l={}){const d=l["open-url"],u=l["media-url"];if(t&&$notify(n,e,c,l),s&&$notification.post(n,e,c+`${u?"\n多媒体:"+u:""}`,{url:d}),i){let t={};d&&(t["openUrl"]=d),u&&(t["mediaUrl"]=u),"{}"===JSON.stringify(t)?$notification.post(n,e,c):$notification.post(n,e,c,t)}if(o||r){const t=c+(d?`\n点击跳转: ${d}`:"")+(u?`\n多媒体: ${u}`:"");a?require("push").schedule({title:n,body:(e?e+"\n":"")+t}):console.log(`${n}\n${e}\n${t}\n\n`)}}log(n){this.debug&&console.log(`[${this.name}] LOG: ${this.stringify(n)}`)}info(n){console.log(`[${this.name}] INFO: ${this.stringify(n)}`)}error(n){console.log(`[${this.name}] ERROR: ${this.stringify(n)}`)}wait(n){return new Promise(e=>setTimeout(e,n))}done(n={}){t||i||s?$done(n):o&&!a&&"undefined"!=typeof $context&&($context.headers=n.headers,$context.statusCode=n.statusCode,$context.body=n.body)}stringify(n){if("string"==typeof n||n instanceof String)return n;try{return JSON.stringify(n,null,2)}catch(n){return"[object Object]"}}}(n,e)}(async()=>{const n=createStyle(),e=createScript(),t=createHTML(),i=isJS?`\nconst bodyELem = document.body;\nbodyELem.insertAdjacentHTML('beforeEnd', \`${n}\`);\nbodyELem.insertAdjacentHTML('beforeEnd', \`${t}\`);\n${e.replace("<script>","").replace("<\/script>","")}\n`:`\n${n}\n${t}\n${e}\n`;try{$.html=isJS?$.html+`\n${i}`:$.html.replace(/(<\/html>)/,`${i} </html>`)}catch(n){console.log(n)}})().catch(n=>{console.log(n)}).finally(()=>{$.headers={...$.headers,"Cache-Control":"no-cache"},$.done({body:$.html,headers:$.headers})});